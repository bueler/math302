\documentclass[urlcolor=blue,dvipsnames]{beamer}

\usepackage[utf8]{inputenc}
\usepackage{fancybox,fancyvrb}
\usepackage{environ,xspace}
\usepackage{tikz}
\hypersetup{colorlinks,linkcolor=,urlcolor=cyan}

\beamertemplatenavigationsymbolsempty
\setbeamertemplate{footline}[frame number]
\usetheme{Pittsburgh}

\newcommand\enumnum[1]{{\renewcommand{\insertenumlabel}{#1}%
      \usebeamertemplate{enumerate item} \,}}

\newcommand{\grad}{\nabla}
\newcommand{\ih}{\boldsymbol{\hat{\textbf{\i}}}}
\newcommand{\jh}{\boldsymbol{\hat{\textbf{\j}}}}
\newcommand{\vF}{\boldsymbol{\vec{\textbf{F}}}}
\newcommand{\Matlab}{\textsc{Matlab}\xspace}
\newcommand{\Octave}{\textsc{Octave}\xspace}


\title{5.3 Nonlinear models \\ (with 4.10 material too)}

\subtitle{a lesson for MATH F302 Differential Equations}

\author{Ed Bueler, Dept.~of Mathematics and Statistics, UAF}

\date{\tiny \today}


\begin{document}
\setbeamertemplate{itemize item}{$\bullet$}
\setbeamertemplate{itemize subitem}{$\circ$}


\begin{frame}
\titlepage

\centerline{\tiny for textbook: \, D. Zill, \emph{A First Course in Differential Equations with Modeling Applications}, 11th ed.}
%\color{green!40!blue}
\end{frame}


\begin{frame}{outline}

examples of nonlinear 2nd-order differential equations (DEs):

\begin{itemize}
\item pendulum (\S 5.3)
\item using a numerical solver in \Matlab/\Octave (see \S4.10)
\item hard and soft springs (\S 5.3)
\item non-constant gravity: from earth to high orbit (\S 5.3)
\item dependent variable missing (\S 4.10)
\end{itemize}
\end{frame}


\begin{frame}{nonlinear pendulum}

\begin{columns}
\begin{column}{0.7\textwidth}
\begin{itemize}
\item suppose a pendulum oscillates (swings back and forth) without resistance
\item if you believe my \S5.1 slides then it must be modeled by a 2nd-order linear DE
     \begin{itemize}
     \item this is true for small oscillations 
     \item for bigger oscillations (more than 20$^\circ$?) a nonlinear model is more accurate
     \end{itemize}
\item the DE which comes from the diagram:
    $$m \ell \frac{d^2\theta}{dt^2} = - mg \sin\theta$$

\vspace{-2mm}
     \begin{itemize}
     \item you are not responsible for the derivation
     \item \dots but $s=\ell \theta$ is arclength, so $\ell \frac{d^2\theta}{dt^2}$ is acceleration, and only the tangential force is relevant
     \end{itemize}
\end{itemize}
\end{column}
\begin{column}{0.3\textwidth}
\includegraphics[width=\textwidth]{figs/pendulum}
\end{column}
\end{columns}
\end{frame}


\begin{frame}{linear small angle model}

\begin{itemize}
\item divide by $m\ell$ and move term: \quad $\displaystyle \frac{d^2\theta}{dt^2} + \frac{g}{\ell} \sin\theta = 0$
\item if $\displaystyle \omega = \sqrt{\frac{g}{\ell}}$ then \, $\displaystyle \boxed{\frac{d^2\theta}{dt^2} + \omega^2 \sin\theta = 0}$ \, for any angle
\item recall $\sin\theta \approx \theta$ for small $\theta$ because $\sin z = z - \frac{z^3}{3!} + \frac{z^5}{5!} - \dots$
\item a \emph{small angle model}:
    $$\boxed{\frac{d^2\theta}{dt^2} + \omega^2 \theta = 0} \hspace{20mm}$$
    \begin{itemize}
    \item solution: $\theta(t) = c_1 \cos(\omega t) + c_2 \sin(\omega t)$
    \end{itemize}
\end{itemize}

\vspace{-30mm}
\hfill \includegraphics[width=0.25\textwidth]{figs/pendulum}

\end{frame}


\begin{frame}{nonlinear versus linearized pendulum}

\begin{center}
\begin{tabular}{c|c}
nonlinear: any angles & linearized: small angles \\ \hline
$\Huge \strut$ $\displaystyle {\color{Green} \theta'' + \omega^2 \sin\theta = 0}$ & $\displaystyle \theta'' + \omega^2 \theta = 0$ \\ \hline
$\huge \strut$ solution? & $\theta(t) = c_1 \cos(\omega t) + c_2 \sin(\omega t)$
\end{tabular}
\end{center}

\begin{itemize}
\item $\omega = \sqrt{g/\ell\,}$ in both DEs
\item we don't know how to solve a nonlinear DE like a {\color{Green} pendulum}
    \begin{itemize}
    \item the term ``${\color{Green} \sin\theta}$'' is not linear: $\sin(a+b)\ne \sin(a)+\sin(b)$
    \end{itemize}
\end{itemize}
\end{frame}


\begin{frame}{what to do about a nonlinear DE?}

\begin{itemize}
\item pendulum DE:
    $$\theta'' + \omega^2 \sin\theta = 0$$
\item what to do about a nonlinear equation like this?
    \begin{itemize}
    \item $\theta=e^{rt}$ is not a solution for any $r$, whether real or complex
    \item using the concept of \emph{energy} makes progress (Mini-Project 3) \dots but we get a hard-to-solve 1st-order equation
    \item using infinite series can make progress too (Chapter 6) \dots but basically only gives approximations
    \end{itemize}
\item numerical approximations for an IVP? $\large \strut$
    \begin{itemize}
    \item Euler's method? \dots inefficient but would work
    \item \emph{but} the equation is second order \dots how does Euler even work?
    \item next: using an efficient ``black box'' solver in \footnotesize \Matlab/\Octave
    \end{itemize}
\item \alert{read section 4.10!}
\end{itemize}
\end{frame}


\begin{frame}{key idea: a system of 1st-order ODEs}

\medskip

   \centerline{\alert{a 2nd-order ODE is equivalent to a system of 1st-order ODEs}}

\noindent \emph{Example.} convert into a 1st-order system:
    $$x''+5(x')^2+\sin x \stackrel{\ast}{=} \sqrt{t}$$

\noindent \emph{Solution.}  The solution is $x(t)$, and the second derivative $x''(t)$ is merely the derivative of $x'(t)$.  So give $x'$ a name:
    $$y = x'.$$
Now rewrite $\ast$ using $y$:
    $$y' + 5 y^2 + \sin x = \sqrt{t}.$$
Now we have a system:
\begin{align*}
x' &= y \\
y' &= - 5 y^2 - \sin x + \sqrt{t}
\end{align*}

\medskip
\scriptsize
\alert{Summary: Ignore the complexity of $\ast$.  Don't solve anything.  Just restate the problem.}
\end{frame}


\begin{frame}{pendulum as a 1st-order system}

\noindent \emph{exercise.}  convert into a 1st-order system with initial conditions:
    $$\theta''+ \omega^2 \sin\theta = 0, \qquad \theta(0)=A, \quad \theta'(0)=B$$

\noindent \emph{solution.}  

\vspace{50mm}
\end{frame}


\begin{frame}[fragile]
\frametitle{using a black-box solver}

\begin{itemize}
\item before we get to systems, let's solve a single 1st-order IVP
\item you can use \href{https://octave-online.net/}{Octave Online} to do the following
\item or use \href{https://www.mathworks.com/products/matlab.html}{\Matlab} or \href{https://www.gnu.org/software/octave/}{\Octave} on your own computer
\end{itemize}

\noindent \emph{example.}  solve on $0 \le t \le 2$ and estimate $y(2)$:
    $$y' = - 3 y + e^{-t}, \quad y(0)=1$$

\noindent \emph{solution.}

\begin{Verbatim}
>> f = @(t,y) -3*y + exp(-t);
>> [tt,yy] = ode45(f,[0,2],1);
>> plot(tt,yy)
>> yy(end)
ans =  0.068908
\end{Verbatim}

\vspace{-25mm}
\hfill \includegraphics[width=0.4\textwidth]{figs/ode45out}
\end{frame}


\begin{frame}{in Octave Online}

\includegraphics[width=1.05\textwidth]{figs/octaveonline}
\end{frame}


\begin{frame}[fragile]
\frametitle{only 12 steps, but accurate}

\begin{itemize}
\item the \texttt{ode45} black-box is quite accurate
\item \emph{exercise.} solve for the exact value $y(2)$:
    $$y' = - 3 y + e^{-t}, \quad y(0)=1$$

\noindent \emph{solution.}

\vspace{30mm}
\item compare:

\begin{Verbatim}
>> 0.5*(exp(-2)+exp(-6))
ans =  0.068907
\end{Verbatim}
\item Euler would need $10^5$ or $10^6$ steps for this accuracy
\end{itemize}
\end{frame}


\begin{frame}{X}

\begin{itemize}
\item X
\end{itemize}
\end{frame}


\begin{frame}{X}

\begin{itemize}
\item X
\end{itemize}
\end{frame}


\begin{frame}{X}

\begin{itemize}
\item X
\end{itemize}
\end{frame}


\begin{frame}{X}

\begin{itemize}
\item X
\end{itemize}
\end{frame}


\begin{frame}{expectations}

\begin{itemize}
\item just watching this video is \emph{not} enough!
     \begin{itemize}
     \item see ``found online'' videos at

     \centerline{\href{https://bueler.github.io/math302/week8.html}{\tt \color{cyan} bueler.github.io/math302/week8.html}}
     \item \emph{read} section 4.10 in the textbook
         \begin{itemize}
         \item skip the ``Use of Taylor series'' material \dots we'll get to it later
         \end{itemize}
     \item \emph{read} section 5.3 in the textbook
         \begin{itemize}
         \item you can safely skip the material on ``Telephone wires'' (a boundary value problem \dots not in Math 302)
         \end{itemize}
     \item \emph{do} the WebAssign exercises for section 5.3, which include some problems from 4.10
     \end{itemize}
\end{itemize}
\end{frame}

\end{document}

